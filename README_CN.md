# Arduino ESP32 Websocket
这个库是基于Espressif arduino-esp32 构建的.
只在ESP32完成了测试，我不确定是否支持ESP8266。
因为我觉得ESP32-WROOM-32模组和ESP8266-12F模组价格差不多，没有理由再使用ESP8266。

我写这个库之前也用过两个Github上star最多的两个库，那两个也不错。

但是第一个库连接速度太慢，握手过程需要大概 1700 ~ 1900毫秒，而正常情况下只需要90 ~ 110毫秒，在大约同样的时间连接同样的服务器。

第二个库使用websocket服务器的时候有内存泄漏，我尝试修复他那个bug但是没有找到怎么修复。

这个库不支持wss服务器和客户端，因为我觉得发数据之前先用AES加密数据安全性更高，https也不是绝对安全的，但是AES-CBC-256目前是绝对安全的，当然，你得有同样的解密密匙，这个就取决于你的设计了。

2022/05/23 默认例子里补了点中文注释

# 这个项目的特点

### 快速
连接和数据传输速度都很快。

连接(握手)速度和Chrome websocket客户端一样，到我的服务器需要98ms。

### 使用简单
看一眼例子10秒钟就会用了。

### 没有内存泄漏
客户端和服务器都经过了数天的高强度测试，数据规模是单次16KB，二进制和文本都分别进行了测试，每次测试使用随机函数生成随机长度的字节数组或字符串，使用sha256对传输的数据完整性进行校验，服务器和客户端互相发送数据互相校验。

### 非常简单就可以创建一个服务器同时处理HTTP请求和Websocket请求
一行代码就可以创建一个同时处理两种请求的服务器，非常简单，非常适合新手。

### 稳定
AP模式和STA模式都可以轻松的传输64KB的二进制数据，处理速度很快，测试过程放在了一个比较复杂的项目中，测试了一万多次，数据都使用sha256校验，没有任何错误。一般情况下堆内存会剩余大概280KB，所以我觉得一次性传输128KB都没问题，当然这个取决于你的堆内存剩余。

### 注意事项
使用客户端的时候，你可以尝试制造断开连接，比如让服务器下线，重复多次后你会发现每次堆内存都会少一点，大概100字节，超过10次以上这个数据就不会减少了，这个不是内存泄漏，有关这个问题你可以取google搜索"lwip memory leak"，有个帖子里面讲了这个问题的原因。

其他的配置你可以在头文件["mywebsocket.h"](https://github.com/vidalouiswang/Arduino_ESP32_Websocket/blob/main/mywebsocket/mywebsocket.h)中找到。
缓存定义的都比较大，因为ESP32堆内存实在是很大，如果你觉得太大你可以自己调小一点。

# 协议
(GNU General Public License v3.0 License)

Copyright 2022, Vida Wang  <github@vida.wang>


孩子是人类的未来，但是现在全世界仍然有许多孩子饱受饥饿，如果你是个善良的人、认可我的代码，请捐助联合国儿童基金会，谢谢。
https://unicef.cn
